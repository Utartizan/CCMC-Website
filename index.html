<html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CCMC Advanced Technologies | Predictive Engine</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://code.iconify.design/3/3.1.0/iconify.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&amp;family=JetBrains+Mono:wght@400;500&amp;display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #475569; }
        input[type=range] { -webkit-appearance: none; background: transparent; }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none; height: 14px; width: 14px; border-radius: 50%;
            background: #e2e8f0; border: 2px solid #0f172a; cursor: pointer; margin-top: -5px;
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%; height: 4px; cursor: pointer; background: #334155; border-radius: 2px;
        }
        .hidden-view { display: none; }
        .typing-cursor { animation: blink 1s step-end infinite; }
        @keyframes blink { 50% { opacity: 0; } }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
        .log-entry { animation: fadeIn 0.3s ease-out; }
        @keyframes pulse-ring { 0% { transform: scale(0.8); opacity: 1; } 100% { transform: scale(2); opacity: 0; } }
        .pulse-ring { animation: pulse-ring 2s ease-out infinite; }
        body {
    .font-inter { font-family: "Inter", sans-serif !important; }
    .font-jetbrains { font-family: "JetBrains Mono", monospace !important; }
  }
    </style>
</head>
<body class="bg-slate-950 text-slate-300 font-sans antialiased h-screen overflow-hidden flex flex-col md:flex-row">

    <aside class="w-full md:w-16 lg:w-56 border-r border-white/5 bg-slate-950 flex flex-col flex-shrink-0 z-20">
        <div class="h-14 flex items-center px-4 lg:px-5 border-b border-white/5">
            <div class="flex items-center gap-2.5">
                <div class="w-8 h-8 flex items-center justify-center">
                    <img src="https://i.ibb.co/v64vk64R/image-removebg-preview-modified.png" alt="CCMC logo" class="w-full h-full object-contain" loading="eager" referrerpolicy="no-referrer">
                </div>
                <span class="hidden lg:block font-medium text-white text-xs tracking-tight">CCMC Advanced Technologies</span>
            </div>
        </div>
        <nav class="flex-1 py-4 flex flex-col gap-0.5 px-2">
            <button onclick="switchTab('story')" id="nav-story" class="nav-item w-full flex items-center gap-2.5 px-3 py-2 rounded-md bg-white/5 text-white text-xs transition-colors">
                <span class="iconify w-4 h-4" data-icon="lucide:book-open" data-stroke-width="1.5"></span>
                <span class="hidden lg:block">The Signal</span>
            </button>
            <button onclick="switchTab('dashboard')" id="nav-dashboard" class="nav-item w-full flex items-center gap-2.5 px-3 py-2 rounded-md text-slate-400 hover:text-white hover:bg-white/5 text-xs transition-colors">
                <span class="iconify w-4 h-4" data-icon="lucide:layout-dashboard" data-stroke-width="1.5"></span>
                <span class="hidden lg:block">Dashboard</span>
            </button>
            <button onclick="switchTab('risk')" id="nav-risk" class="nav-item w-full flex items-center gap-2.5 px-3 py-2 rounded-md text-slate-400 hover:text-white hover:bg-white/5 text-xs transition-colors">
                <span class="iconify w-4 h-4" data-icon="lucide:shield-alert" data-stroke-width="1.5"></span>
                <span class="hidden lg:block">Risk Monitor</span>
            </button>
            <button onclick="switchTab('stress')" id="nav-stress" class="nav-item w-full flex items-center gap-2.5 px-3 py-2 rounded-md text-slate-400 hover:text-white hover:bg-white/5 text-xs transition-colors">
                <span class="iconify w-4 h-4" data-icon="lucide:zap" data-stroke-width="1.5"></span>
                <span class="hidden lg:block">Stress Test</span>
            </button>

            <button onclick="switchTab('team')" id="nav-team" class="nav-item w-full flex items-center gap-2.5 px-3 py-2 rounded-md text-slate-400 hover:text-white hover:bg-white/5 text-xs transition-colors">
                <span class="iconify w-4 h-4" data-icon="lucide:users" data-stroke-width="1.5"></span>
                <span class="hidden lg:block">Team</span>
            </button>
        </nav>
        <div class="p-4 border-t border-white/5 hidden lg:block">
            <div class="flex items-center gap-2 mb-1.5">
                <div id="engineStatus" class="w-1.5 h-1.5 rounded-full bg-emerald-500"></div>
                <span class="text-[10px] font-mono text-slate-500 uppercase tracking-wider">Aqua Blue Online</span>
            </div>
            <div class="text-[10px] text-slate-600 font-mono">Echo State Network v2.4</div>
        </div>
    </aside>

    <main class="flex-1 flex flex-col h-full overflow-hidden relative">
        <div class="flex-1 overflow-y-auto" id="main-scroll">
            
            <!-- The Signal View - Complete Redesign -->
            <div id="view-story" class="view-section">
                
                <!-- Hero Section -->
                <div class="relative border-b border-white/5 overflow-hidden">
                    <div class="absolute inset-0 bg-gradient-to-b from-blue-500/5 via-transparent to-transparent"></div>
                    <div class="max-w-5xl mx-auto px-6 py-16 md:py-24 relative">
                        <div class="flex items-center gap-2 mb-6">
                            <div class="w-2 h-2 rounded-full bg-blue-500"></div>
                            <span class="text-xs font-mono text-blue-400 uppercase tracking-wider">Reducing Information Asymmetry</span>
                        </div>
                        <h1 class="text-4xl md:text-6xl font-medium text-white tracking-tight mb-6" style="line-height: 1.1;">
                            You already know how<br class="hidden md:block"> Prometheus works.
                        </h1>
                        <p class="text-base md:text-lg text-slate-400 max-w-2xl leading-relaxed">
                            Whether you operate supply chains, manage financial exposure, oversee infrastructure, or make decisions under uncertainty, your organization already relies on implicit forecasting logic. 
                            Prometheus formalizes that logic into a transparent, continuously learning time-series engine—designed to reduce information asymmetry, surface risk early, and improve decision quality across the enterprise.                        </p>
                    </div>
                </div>

                <!-- Phase 1: The Expert's Intuition -->
                <div class="border-b border-white/5">
                    <div class="max-w-5xl mx-auto px-6 py-16">
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
                            <div>
                                <div class="flex items-center gap-2 mb-4">
                                    <span class="w-6 h-6 rounded-full bg-slate-800 flex items-center justify-center text-xs font-mono text-white">1</span>
                                    <span class="text-xs font-mono text-slate-500 uppercase tracking-wider">Personal Mastery</span>
                                </div>
                                <h2 class="text-2xl font-medium text-white tracking-tight mb-4">
                                    Think about what puts you in flow.
                                </h2>
                                <p class="text-sm text-slate-400 mb-6 leading-relaxed">
                                    Every organization continuously interprets signals: demand fluctuations, operational load, market conditions, regulatory constraints. Most of this interpretation happens implicitly—through heuristics, dashboards, and institutional experience—until signals are missed, risks materialize, or decisions arrive too late.                                </p>
                                <div class="space-y-3">
                                    <div class="flex items-start gap-3 p-3 rounded-lg bg-slate-900/50 border border-white/5">
                                        <span class="iconify w-4 h-4 text-blue-400 mt-0.5 flex-shrink-0" data-icon="lucide:gauge" data-stroke-width="1.5"></span>
                                        <div>
                                            <div class="text-xs font-medium text-white mb-0.5">Vital Signs</div>
                                            <div class="text-xs text-slate-500">The 3-4 metrics you instinctively check</div>
                                        </div>
                                    </div>
                                    <div class="flex items-start gap-3 p-3 rounded-lg bg-slate-900/50 border border-white/5">
                                        <span class="iconify w-4 h-4 text-amber-400 mt-0.5 flex-shrink-0" data-icon="lucide:eye" data-stroke-width="1.5"></span>
                                        <div>
                                            <div class="text-xs font-medium text-white mb-0.5">Pattern Recognition</div>
                                            <div class="text-xs text-slate-500">Seeing what beginners can't see</div>
                                        </div>
                                    </div>
                                    <div class="flex items-start gap-3 p-3 rounded-lg bg-slate-900/50 border border-white/5">
                                        <span class="iconify w-4 h-4 text-emerald-400 mt-0.5 flex-shrink-0" data-icon="lucide:brain" data-stroke-width="1.5"></span>
                                        <div>
                                            <div class="text-xs font-medium text-white mb-0.5">Invisible Knowledge</div>
                                            <div class="text-xs text-slate-500">What feels obvious to you but confuses others</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-slate-900 border border-white/5 rounded-xl p-6">
                                <div class="flex items-center gap-2 mb-4">
                                    <span class="iconify w-4 h-4 text-slate-400" data-icon="lucide:activity" data-stroke-width="1.5"></span>
                                    <span class="text-xs font-medium text-white">Your Mental Dashboard</span>
                                </div>
                                <div class="h-48 relative">
                                    <canvas id="mentalDashboardChart"></canvas>
                                </div>
                                <p class="text-[10px] text-slate-600 mt-3 text-center">Every expert has one. Prometheus builds it automatically.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Phase 2: The Three Capabilities -->
                <div class="border-b border-white/5 bg-slate-900/30">
                    <div class="max-w-5xl mx-auto px-6 py-16">
                        <div class="flex items-center gap-2 mb-4">
                            <span class="w-6 h-6 rounded-full bg-slate-800 flex items-center justify-center text-xs font-mono text-white">2</span>
                            <span class="text-xs font-mono text-slate-500 uppercase tracking-wider">PreSERVe Method</span>
                        </div>
                        <h2 class="text-2xl font-medium text-white tracking-tight mb-3">
                            What Prometheus actually does.
                        </h2>
                        <p class="text-sm text-slate-400 mb-10 max-w-2xl">
                            Prometheus operationalizes three core capabilities required for effective time-series decision-making across industries: early risk detection, constraint-aware forecasting, and scenario evaluation under uncertainty.                        </p>

                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <!-- Early Warning -->
                            <div class="bg-slate-950 border border-white/5 rounded-xl p-6 hover:border-blue-500/20 transition-colors">
                                <div class="w-10 h-10 rounded-lg bg-blue-500/10 flex items-center justify-center mb-4">
                                    <span class="iconify w-5 h-5 text-blue-400" data-icon="lucide:radar" data-stroke-width="1.5"></span>
                                </div>
                                <h3 class="text-sm font-medium text-white mb-2">Early Warning</h3>
                                <p class="text-xs text-slate-500 mb-4 leading-relaxed">
                                    "Tell me about a time you spotted something 'slightly off' before a big problem. What was the signal, and how did you know it wasn't noise?"
                                </p>
                                <div class="border-t border-white/5 pt-4">
                                    <div class="text-[10px] font-mono text-blue-400 uppercase tracking-wider mb-2">Prometheus Equivalent</div>
                                    <p class="text-xs text-slate-400">
                                        Continuous monitoring for anomalies against learned baselines. Distinguishes signal from noise using reservoir dynamics.
                                    </p>
                                </div>
                            </div>

                            <!-- Compliance -->
                            <div class="bg-slate-950 border border-white/5 rounded-xl p-6 hover:border-amber-500/20 transition-colors">
                                <div class="w-10 h-10 rounded-lg bg-amber-500/10 flex items-center justify-center mb-4">
                                    <span class="iconify w-5 h-5 text-amber-400" data-icon="lucide:shield-check" data-stroke-width="1.5"></span>
                                </div>
                                <h3 class="text-sm font-medium text-white mb-2">Rulebook</h3>
                                <p class="text-xs text-slate-500 mb-4 leading-relaxed">
                                    "Does your domain have strict standards? How do you confirm you're following them without slowing down?"
                                </p>
                                <div class="border-t border-white/5 pt-4">
                                    <div class="text-[10px] font-mono text-amber-400 uppercase tracking-wider mb-2">Prometheus Equivalent</div>
                                    <p class="text-xs text-slate-400">
                                        Embedded constraints and thresholds that validate outputs in real-time without manual review.
                                    </p>
                                </div>
                            </div>

                            <!-- OODA -->
                            <div class="bg-slate-950 border border-white/5 rounded-xl p-6 hover:border-emerald-500/20 transition-colors">
                                <div class="w-10 h-10 rounded-lg bg-emerald-500/10 flex items-center justify-center mb-4">
                                    <span class="iconify w-5 h-5 text-emerald-400" data-icon="lucide:rotate-ccw" data-stroke-width="1.5"></span>
                                </div>
                                <h3 class="text-sm font-medium text-white mb-2">Pivot</h3>
                                <p class="text-xs text-slate-500 mb-4 leading-relaxed">
                                    "For a non-routine problem, what's your mental checklist? How do you decide to fix immediately or monitor?"
                                </p>
                                <div class="border-t border-white/5 pt-4">
                                    <div class="text-[10px] font-mono text-emerald-400 uppercase tracking-wider mb-2">Prometheus Equivalent</div>
                                    <p class="text-xs text-slate-400">
                                        Scenario simulation that lets you test interventions before committing. Observe-Orient-Decide-Act in milliseconds.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Phase 3: The Live Demo -->
                <div class="border-b border-white/5">
                    <div class="max-w-5xl mx-auto px-6 py-16">
                        <div class="flex items-center gap-2 mb-4">
                            <span class="w-6 h-6 rounded-full bg-slate-800 flex items-center justify-center text-xs font-mono text-white">3</span>
                            <span class="text-xs font-mono text-slate-500 uppercase tracking-wider">See It Work</span>
                        </div>
                        <h2 class="text-2xl font-medium text-white tracking-tight mb-3">
                            Watch the signal emerge from noise.
                        </h2>
                        <p class="text-sm text-slate-400 mb-8 max-w-2xl">
                            Prometheus uses Echo State Network–based reservoir computing to extract predictive structure from noisy, non-stationary time series. Models retrain in seconds, adapt to regime changes, and remain fully interpretable—making them suitable for operational, financial, and regulatory environments.                        </p>

                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                            <div class="lg:col-span-2 bg-slate-900 border border-white/5 rounded-xl overflow-hidden">
                                <div class="h-10 border-b border-white/5 flex items-center justify-between px-4">
                                    <div class="flex items-center gap-2">
                                        <span class="w-2 h-2 rounded-full bg-emerald-500"></span>
                                        <span class="text-xs font-medium text-white">Real-Time Signal Extraction</span>
                                    </div>
                                    <span id="signalStatus" class="text-[10px] font-mono text-slate-500">Ready</span>
                                </div>
                                <div class="p-4 h-72">
                                    <canvas id="signalExtractionChart"></canvas>
                                </div>
                            </div>
                            <div class="space-y-4">
                                <div class="bg-slate-900 border border-white/5 rounded-xl p-4">
                                    <div class="text-[10px] font-mono text-slate-500 uppercase tracking-wider mb-3">Process Log</div>
                                    <div id="processLog" class="font-mono text-[11px] space-y-1 h-40 overflow-y-auto text-slate-500">
                                        <div class="text-slate-600 italic">Click "Extract Signal" to begin</div>
                                    </div>
                                </div>
                                <button onclick="runSignalDemo()" class="w-full bg-white text-slate-950 text-xs font-medium py-3 rounded-lg hover:bg-slate-200 transition-colors flex items-center justify-center gap-2">
                                    <span class="iconify w-4 h-4" data-icon="lucide:play" data-stroke-width="1.5"></span>
                                    Extract Signal
                                </button>
                            </div>
                        </div>

                        <!-- Results Cards -->
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-6" id="resultsCards" style="opacity: 0.4;">
                            <div class="bg-slate-900/50 border border-white/5 rounded-lg p-4 text-center">
                                <div id="resultAccuracy" class="text-xl font-medium text-white mb-1">--</div>
                                <div class="text-[10px] text-slate-500 uppercase tracking-wider">Mean MAE (MW)</div>
                            </div>
                            <div class="bg-slate-900/50 border border-white/5 rounded-lg p-4 text-center">
                                <div id="resultLatency" class="text-xl font-medium text-white mb-1">--</div>
                                <div class="text-[10px] text-slate-500 uppercase tracking-wider">Train Time</div>
                            </div>
                            <div class="bg-slate-900/50 border border-white/5 rounded-lg p-4 text-center">
                                <div id="resultHorizon" class="text-xl font-medium text-white mb-1">--</div>
                                <div class="text-[10px] text-slate-500 uppercase tracking-wider">Horizon</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Phase 4: The Analogy -->
                <div class="border-b border-white/5 bg-gradient-to-b from-slate-900/50 to-transparent">
                    <div class="max-w-5xl mx-auto px-6 py-16">
                        <div class="flex items-center gap-2 mb-4">
                            <span class="w-6 h-6 rounded-full bg-slate-800 flex items-center justify-center text-xs font-mono text-white">4</span>
                            <span class="text-xs font-mono text-slate-500 uppercase tracking-wider">Mental Model</span>
                        </div>
                        <h2 class="text-2xl font-medium text-white tracking-tight mb-8">
                            Pick the metaphor that clicks for you.
                        </h2>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="bg-slate-900 border border-white/5 rounded-xl p-6 hover:border-blue-500/30 transition-colors cursor-pointer group" onclick="selectAnalogy('immune')">
                                <div class="flex items-center justify-between mb-4">
                                    <div class="flex items-center gap-3">
                                        <div class="w-12 h-12 rounded-xl bg-blue-500/10 flex items-center justify-center">
                                            <span class="iconify w-6 h-6 text-blue-400" data-icon="lucide:shield" data-stroke-width="1.5"></span>
                                        </div>
                                        <h3 class="text-base font-medium text-white">Immune System</h3>
                                    </div>
                                    <div id="immuneCheck" class="w-5 h-5 rounded-full border border-white/20 flex items-center justify-center opacity-0 group-hover:opacity-50 transition-opacity">
                                        <span class="iconify w-3 h-3 text-white" data-icon="lucide:check" data-stroke-width="2"></span>
                                    </div>
                                </div>
                                <p class="text-sm text-slate-400 leading-relaxed">
                                    Like your body's immune system, Prometheus continuously scans for threats and anomalies 24/7. It learns what "healthy" looks like, detects deviations before they become problems, and triggers appropriate responses—all without conscious intervention.
                                </p>
                            </div>

                            <div class="bg-slate-900 border border-white/5 rounded-xl p-6 hover:border-amber-500/30 transition-colors cursor-pointer group" onclick="selectAnalogy('cockpit')">
                                <div class="flex items-center justify-between mb-4">
                                    <div class="flex items-center gap-3">
                                        <div class="w-12 h-12 rounded-xl bg-amber-500/10 flex items-center justify-center">
                                            <span class="iconify w-6 h-6 text-amber-400" data-icon="lucide:gauge" data-stroke-width="1.5"></span>
                                        </div>
                                        <h3 class="text-base font-medium text-white">Flight Data Recorder</h3>
                                    </div>
                                    <div id="cockpitCheck" class="w-5 h-5 rounded-full border border-white/20 flex items-center justify-center opacity-0 group-hover:opacity-50 transition-opacity">
                                        <span class="iconify w-3 h-3 text-white" data-icon="lucide:check" data-stroke-width="2"></span>
                                    </div>
                                </div>
                                <p class="text-sm text-slate-400 leading-relaxed">
                                    Like a cockpit's flight data recorder combined with predictive autopilot, Prometheus captures every data point, identifies patterns pilots would miss, and provides early warnings with enough lead time to take corrective action.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- The Core Difference -->
                <div class="border-b border-white/5">
                    <div class="max-w-5xl mx-auto px-6 py-16">
                        <div class="text-center mb-12">
                            <h2 class="text-2xl md:text-3xl font-medium text-white tracking-tight mb-4">
                                Why Echo State Networks?
                            </h2>
                            <p class="text-sm text-slate-400 max-w-xl mx-auto">
                                Traditional deep learning requires massive data, expensive hardware, and opaque decision-making. We chose a different path.
                            </p>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                            <div class="text-center">
                                <div class="w-16 h-16 rounded-2xl bg-gradient-to-br from-blue-500/20 to-blue-500/5 flex items-center justify-center mx-auto mb-4 border border-blue-500/20">
                                    <span class="iconify w-7 h-7 text-blue-400" data-icon="lucide:zap" data-stroke-width="1.5"></span>
                                </div>
                                <div class="text-2xl font-medium text-white mb-1">&lt;1s</div>
                                <div class="text-xs text-slate-500 uppercase tracking-wider mb-3">Retrain Time</div>
                                <p class="text-xs text-slate-400 leading-relaxed">
                                    Regime changes? Market shifts? Prometheus adapts in under a second. No waiting hours for model retraining.
                                </p>
                            </div>
                            <div class="text-center">
                                <div class="w-16 h-16 rounded-2xl bg-gradient-to-br from-emerald-500/20 to-emerald-500/5 flex items-center justify-center mx-auto mb-4 border border-emerald-500/20">
                                    <span class="iconify w-7 h-7 text-emerald-400" data-icon="lucide:eye" data-stroke-width="1.5"></span>
                                </div>
                                <div class="text-2xl font-medium text-white mb-1">100%</div>
                                <div class="text-xs text-slate-500 uppercase tracking-wider mb-3">Interpretable</div>
                                <p class="text-xs text-slate-400 leading-relaxed">
                                    No black boxes. Every prediction can be traced back to its contributing factors. Audit-ready by design.
                                </p>
                            </div>
                            <div class="text-center">
                                <div class="w-16 h-16 rounded-2xl bg-gradient-to-br from-amber-500/20 to-amber-500/5 flex items-center justify-center mx-auto mb-4 border border-amber-500/20">
                                    <span class="iconify w-7 h-7 text-amber-400" data-icon="lucide:cpu" data-stroke-width="1.5"></span>
                                </div>
                                <div class="text-2xl font-medium text-white mb-1">CPU</div>
                                <div class="text-xs text-slate-500 uppercase tracking-wider mb-3">Infrastructure</div>
                                <p class="text-xs text-slate-400 leading-relaxed">
                                    Runs on standard hardware. No GPUs required. Deploy anywhere—cloud, edge, or on-premise.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- How You'll Learn -->
                <div class="border-b border-white/5 bg-slate-900/30">
                    <div class="max-w-5xl mx-auto px-6 py-16">
                        <h2 class="text-2xl font-medium text-white tracking-tight mb-3">
                            How would you prefer to learn?
                        </h2>
                        <p class="text-sm text-slate-400 mb-8 max-w-xl">
                            We customize onboarding based on how you best absorb new information.
                        </p>

                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div class="bg-slate-950 border border-white/5 rounded-xl p-5 hover:border-white/10 transition-colors">
                                <div class="flex items-center gap-3 mb-3">
                                    <span class="iconify w-5 h-5 text-blue-400" data-icon="lucide:layout-grid" data-stroke-width="1.5"></span>
                                    <span class="text-sm font-medium text-white">Big-Picture Diagram</span>
                                </div>
                                <p class="text-xs text-slate-500 leading-relaxed">
                                    Visual system maps showing how data flows through Prometheus, with clear annotations on each component.
                                </p>
                            </div>
                            <div class="bg-slate-950 border border-white/5 rounded-xl p-5 hover:border-white/10 transition-colors">
                                <div class="flex items-center gap-3 mb-3">
                                    <span class="iconify w-5 h-5 text-emerald-400" data-icon="lucide:list-ordered" data-stroke-width="1.5"></span>
                                    <span class="text-sm font-medium text-white">Step-by-Step Manual</span>
                                </div>
                                <p class="text-xs text-slate-500 leading-relaxed">
                                    Sequential walkthrough of each feature with hands-on exercises and checkpoints.
                                </p>
                            </div>
                            <div class="bg-slate-950 border border-white/5 rounded-xl p-5 hover:border-white/10 transition-colors">
                                <div class="flex items-center gap-3 mb-3">
                                    <span class="iconify w-5 h-5 text-amber-400" data-icon="lucide:book-open" data-stroke-width="1.5"></span>
                                    <span class="text-sm font-medium text-white">Real-World Stories</span>
                                </div>
                                <p class="text-xs text-slate-500 leading-relaxed">
                                    Case studies showing how Prometheus performed in actual scenarios, with lessons learned.
                                </p>
                            </div>
                        </div>

                        <div class="mt-8 p-6 bg-slate-950 border border-white/5 rounded-xl">
                            <div class="flex items-center gap-3 mb-4">
                                <span class="iconify w-5 h-5 text-slate-400" data-icon="lucide:bell" data-stroke-width="1.5"></span>
                                <span class="text-sm font-medium text-white">How do you prefer feedback?</span>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <!-- Real-Time Alerts -->
                            <button
                                type="button"
                                id="feedback-realTime"
                                onclick="selectFeedbackPreference('realtime')"
                                class="feedback-option text-left flex items-center gap-3 p-3 rounded-lg border border-white/5 hover:border-blue-500/30 cursor-pointer transition-colors w-full"
                            >
                                <div class="w-4 h-4 rounded-full border-2 border-slate-600 flex items-center justify-center">
                                <div class="feedback-dot w-2 h-2 rounded-full bg-blue-400 hidden"></div>
                                </div>
                                <div>
                                <div class="text-xs font-medium text-white">Real-Time Alerts</div>
                                <div class="text-[10px] text-slate-500">Immediate notification on anomalies or threshold breaches</div>
                                </div>
                            </button>

                            <!-- Daily Digest -->
                            <button
                                type="button"
                                id="feedback-dailyDigest"
                                onclick="selectFeedbackPreference('digest')"
                                class="feedback-option text-left flex items-center gap-3 p-3 rounded-lg border border-white/5 hover:border-blue-500/30 cursor-pointer transition-colors w-full"
                            >
                                <div class="w-4 h-4 rounded-full border-2 border-slate-600 flex items-center justify-center">
                                <div class="feedback-dot w-2 h-2 rounded-full bg-blue-400 hidden"></div>
                                </div>
                                <div>
                                <div class="text-xs font-medium text-white">Daily Digest</div>
                                <div class="text-[10px] text-slate-500">End-of-day summary comparing performance against goals</div>
                                </div>
                            </button>
                            </div>

                            <!-- Appears only after a selection -->
                            <div
                            id="feedbackContactCta"
                            class="hidden mt-5 p-5 bg-slate-900/60 border border-white/5 rounded-xl"
                            >
                            <div class="flex items-start gap-3">
                                <span class="iconify w-5 h-5 text-blue-400 mt-0.5" data-icon="lucide:mail" data-stroke-width="1.5"></span>
                                <div class="flex-1">
                                <div class="text-xs font-medium text-white">Enable <span id="feedbackChoiceLabel">your preference</span></div>
                                <p class="text-xs text-slate-400 mt-1 leading-relaxed">
                                    To activate this delivery mode and configure recipients, escalation rules, and service levels, contact the CCMC Business/Support team:
                                </p>

                                <div class="mt-3 flex flex-col sm:flex-row sm:items-center gap-3">
                                    <a
                                    href="mailto:business.team@ccmc.global?subject=Prometheus%20-%20Feedback%20Delivery%20Setup&body=Hi%20CCMC%20Team%2C%0A%0AI%27d%20like%20to%20enable%20the%20Prometheus%20feedback%20mode%3A%20%5BREAL-TIME%20ALERTS%20or%20DAILY%20DIGEST%5D.%0A%0APlease%20advise%20on%20setup%2C%20integrations%2C%20and%20onboarding%20steps.%0A%0AThanks%2C%0A"
                                    class="inline-flex items-center justify-center gap-2 px-4 py-2 bg-white text-slate-950 text-xs font-medium rounded-lg hover:bg-slate-200 transition-colors"
                                    >
                                    <span class="iconify w-4 h-4" data-icon="lucide:send" data-stroke-width="1.5"></span>
                                    Email business.team@ccmc.global
                                    </a>

                                    <div class="text-[10px] text-slate-500 font-mono">
                                    business.team@ccmc.global
                                    </div>
                                </div>

                                <div class="mt-3 text-[10px] text-slate-500">
                                    Include: preferred channels (email/SMS/Teams/Slack), alert thresholds, recipient list, and timezone.
                                </div>
                                </div>
                            </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- CTA Section -->
                <div class="max-w-5xl mx-auto px-6 py-16">
                    <div class="bg-gradient-to-r from-blue-500/10 via-blue-500/5 to-transparent border border-blue-500/20 rounded-2xl p-8 md:p-12">
                        <div class="max-w-2xl">
                            <h2 class="text-2xl md:text-3xl font-medium text-white tracking-tight mb-4">
                                Ready to see your signal?
                            </h2>
                            <p class="text-sm text-slate-400 mb-6 leading-relaxed">
                                If Prometheus guaranteed you'd never miss an early warning in your domain, what's the first question you'd ask?
                            </p>
                            <div class="flex flex-col sm:flex-row gap-3">
                                <button onclick="switchTab('dashboard')" class="px-6 py-3 bg-white text-slate-950 text-sm font-medium rounded-lg hover:bg-slate-200 transition-colors flex items-center justify-center gap-2">
                                    <span class="iconify w-4 h-4" data-icon="lucide:layout-dashboard" data-stroke-width="1.5"></span>
                                    Explore the Dashboard
                                </button>
                                <button onclick="switchTab('simulation')" class="px-6 py-3 bg-transparent text-white text-sm font-medium rounded-lg border border-white/20 hover:bg-white/5 transition-colors flex items-center justify-center gap-2">
                                    <span class="iconify w-4 h-4" data-icon="lucide:sliders-horizontal" data-stroke-width="1.5"></span>
                                    Run a Simulation
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="border-t border-white/5 py-8">
                    <div class="max-w-5xl mx-auto px-6 text-center">
                        <p class="text-[10px] text-slate-600">
                            © 2025 CCMC Advanced Technologies Inc. | Aqua Blue Reservoir Computing Engine | Echo State Network v2.4
                        </p>
                    </div>
                </div>
            </div>

            <!-- Dashboard View -->
            <div id="view-dashboard" class="view-section hidden-view p-6">
            <!-- KPI Cards (unchanged) -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                <div class="bg-slate-900/50 border border-white/5 rounded-lg p-4 hover:border-white/10 transition-all">
                <div class="flex justify-between items-start mb-2">
                    <span class="text-[10px] font-mono uppercase tracking-wider text-slate-500">Mean Load</span>
                    <span class="iconify w-4 h-4 text-slate-600" data-icon="lucide:bar-chart-2" data-stroke-width="1.5"></span>
                </div>
                <div class="text-2xl font-medium text-white tracking-tight"><span id="meanLoadVal">--</span> <span class="text-sm text-slate-500 font-normal">MW</span></div>
                <div class="mt-2 text-[10px] flex items-center gap-1" id="meanLoadDiff"></div>
                </div>

                <div class="bg-slate-900/50 border border-white/5 rounded-lg p-4 hover:border-white/10 transition-all">
                <div class="flex justify-between items-start mb-2">
                    <span class="text-[10px] font-mono uppercase tracking-wider text-slate-500">Accuracy</span>
                    <span class="iconify w-4 h-4 text-slate-600" data-icon="lucide:target" data-stroke-width="1.5"></span>
                </div>
                <div class="text-2xl font-medium text-white tracking-tight"><span id="accuracyVal">--</span><span class="text-sm text-slate-500 font-normal">%</span></div>
                <div class="mt-2 text-[10px] text-slate-400">MAPE: <span id="mapeVal">--</span>%</div>
                </div>

                <div class="bg-slate-900/50 border border-white/5 rounded-lg p-4 hover:border-white/10 transition-all">
                <div class="flex justify-between items-start mb-2">
                    <span class="text-[10px] font-mono uppercase tracking-wider text-slate-500">Reservoir</span>
                    <span class="iconify w-4 h-4 text-slate-600" data-icon="lucide:cpu" data-stroke-width="1.5"></span>
                </div>
                <div class="text-2xl font-medium text-white tracking-tight">300 <span class="text-sm text-slate-500 font-normal">dim</span></div>
                <div class="mt-2 text-[10px] text-slate-400">Echo State Network</div>
                </div>
            </div>

            <!-- Section A: Baseline Forecast + Log (existing Dashboard content) -->
            <div class="grid grid-cols-12 gap-6 mb-6">
                <div class="col-span-12 lg:col-span-8">
                <div class="bg-slate-900 border border-white/5 rounded-lg overflow-hidden h-96">
                    <div class="h-10 border-b border-white/5 bg-slate-900/90 flex items-center justify-between px-4">
                    <h3 class="text-xs font-medium text-slate-300 flex items-center gap-2">
                        <span class="w-2 h-2 rounded-full bg-blue-500"></span>
                        Baseline Forecast &amp; 90% Prediction Interval
                    </h3>
                    <div class="flex items-center gap-3 text-[10px] text-slate-500">
                        <span class="flex items-center gap-1"><span class="w-3 h-0.5 bg-slate-500"></span>Historical</span>
                        <span class="flex items-center gap-1"><span class="w-3 h-0.5 bg-blue-400"></span>Forecast</span>
                    </div>
                    </div>
                    <div class="p-4 h-[calc(100%-2.5rem)]">
                    <canvas id="dashboardChart"></canvas>
                    </div>
                </div>
                </div>

                <div class="col-span-12 lg:col-span-4">
                <div class="bg-slate-900 border border-white/5 rounded-lg p-4 h-96 overflow-hidden">
                    <h3 class="text-xs font-medium text-white mb-3 flex items-center gap-2">
                    <span class="iconify w-3.5 h-3.5 text-slate-400" data-icon="lucide:terminal" data-stroke-width="1.5"></span>
                    System Log
                    </h3>
                    <div id="systemLog" class="font-mono text-[11px] space-y-1 h-[calc(100%-2rem)] overflow-y-auto text-slate-400"></div>
                </div>
                </div>
            </div>

            <!-- Section B: Scenario Simulation (moved from Simulation tab) -->
            <div class="mb-4">
                <div class="flex items-end justify-between gap-4">
                <div>
                    <h3 class="text-sm font-medium text-white tracking-tight">Scenario Simulation</h3>
                    <p class="text-xs text-slate-500 mt-1">Apply shocks and observe forecast adjustments in real-time</p>
                </div>
                <div class="text-[10px] font-mono text-slate-500 uppercase tracking-wider">Horizon: 168h</div>
                </div>
            </div>

            <div class="grid grid-cols-12 gap-6">
                <div class="col-span-12 lg:col-span-4">
                <div class="bg-slate-900 border border-white/5 rounded-lg p-5">
                    <h3 class="text-sm font-medium text-white mb-4 flex items-center gap-2">
                    <span class="iconify w-4 h-4 text-blue-400" data-icon="lucide:sliders-vertical" data-stroke-width="1.5"></span>
                    Shock Parameters
                    </h3>

                    <div class="space-y-5">
                    <div>
                        <div class="flex justify-between mb-1.5">
                        <label class="text-xs text-slate-400">Temperature (°C)</label>
                        <span class="text-xs font-mono text-blue-400" id="tempVal">0</span>
                        </div>
                        <input type="range" id="tempShock" min="-8" max="8" step="0.5" value="0" class="w-full" oninput="updateShockLabel('temp')">
                    </div>

                    <div>
                        <div class="flex justify-between mb-1.5">
                        <label class="text-xs text-slate-400">Economic (%)</label>
                        <span class="text-xs font-mono text-blue-400" id="econVal">0</span>
                        </div>
                        <input type="range" id="econShock" min="-6" max="6" step="0.5" value="0" class="w-full" oninput="updateShockLabel('econ')">
                    </div>

                    <div>
                        <div class="flex justify-between mb-1.5">
                        <label class="text-xs text-slate-400">Policy (index)</label>
                        <span class="text-xs font-mono text-blue-400" id="policyVal">0</span>
                        </div>
                        <input type="range" id="policyShock" min="-4" max="4" step="0.5" value="0" class="w-full" oninput="updateShockLabel('policy')">
                    </div>

                    <div>
                        <div class="flex justify-between mb-1.5">
                        <label class="text-xs text-slate-400">Equipment Outage</label>
                        <span class="text-xs font-mono text-amber-400" id="equipVal">0</span>
                        </div>
                        <input type="range" id="equipShock" min="0" max="3" step="0.1" value="0" class="w-full" oninput="updateShockLabel('equip')">
                    </div>

                    <div class="grid grid-cols-2 gap-3 pt-2">
                        <div>
                        <label class="text-[10px] text-slate-500 uppercase tracking-wider block mb-1">Start (h)</label>
                        <input type="number" id="startStep" value="0" min="0" max="167" class="w-full bg-slate-950 border border-white/10 rounded px-2 py-1.5 text-xs text-white">
                        </div>
                        <div>
                        <label class="text-[10px] text-slate-500 uppercase tracking-wider block mb-1">Duration (h)</label>
                        <input type="number" id="durationSteps" value="48" min="1" max="168" class="w-full bg-slate-950 border border-white/10 rounded px-2 py-1.5 text-xs text-white">
                        </div>
                    </div>

                    <div>
                        <div class="flex justify-between mb-1.5">
                        <label class="text-xs text-slate-400">Decay Rate</label>
                        <span class="text-xs font-mono text-slate-500" id="decayVal">0.03</span>
                        </div>
                        <input type="range" id="decayRate" min="0" max="0.15" step="0.01" value="0.03" class="w-full" oninput="updateShockLabel('decay')">
                    </div>
                    </div>

                    <button onclick="runSimulation()" class="w-full mt-5 bg-white text-slate-950 text-xs font-medium py-2.5 rounded hover:bg-slate-200 transition-colors">
                    Apply Scenario
                    </button>
                </div>
                </div>

                <div class="col-span-12 lg:col-span-8">
                <div class="bg-slate-900 border border-white/5 rounded-lg p-4 h-[400px]">
                    <canvas id="simulationChart"></canvas>
                </div>

                <div class="bg-slate-900/50 border border-white/5 rounded-lg p-4 mt-4">
                    <h4 class="text-xs font-medium text-white mb-2">Scenario Contributions</h4>
                    <div id="contributionLog" class="font-mono text-[11px] text-slate-400 space-y-0.5 max-h-24 overflow-y-auto"></div>
                </div>
                </div>
            </div>
            </div>

            <!-- Risk View -->
            <div id="view-risk" class="view-section hidden-view p-6">
                <div class="mb-6">
                    <h2 class="text-xl font-medium text-white tracking-tight">Risk Monitor</h2>
                    <p class="text-sm text-slate-500 mt-1">Substation risk assessment and pre-storm positioning</p>
                </div>
                <div class="grid grid-cols-12 gap-6">
                    <div class="col-span-12 lg:col-span-8">
                        <div class="bg-slate-900 border border-white/5 rounded-lg p-4 h-[450px]">
                            <canvas id="riskChart"></canvas>
                        </div>
                    </div>
                    <div class="col-span-12 lg:col-span-4 space-y-4">
                        <div class="bg-slate-900 border border-white/5 rounded-lg p-4">
                            <h3 class="text-sm font-medium text-white mb-3 flex items-center gap-2">
                                <span class="iconify w-4 h-4 text-amber-400" data-icon="lucide:alert-triangle" data-stroke-width="1.5"></span>
                                Pre-storm Crew Positioning
                            </h3>
                            <ul id="crewSuggestions" class="text-xs text-slate-400 space-y-2"></ul>
                        </div>
                        <div class="bg-slate-900 border border-white/5 rounded-lg p-4">
                            <h3 class="text-sm font-medium text-white mb-3">Risk Legend</h3>
                            <div class="space-y-2 text-xs">
                                <div class="flex items-center gap-2"><span class="w-3 h-3 rounded-full bg-red-400"></span><span class="text-slate-400">High Risk (&gt;66%)</span></div>
                                <div class="flex items-center gap-2"><span class="w-3 h-3 rounded-full bg-amber-400"></span><span class="text-slate-400">Medium Risk (33-66%)</span></div>
                                <div class="flex items-center gap-2"><span class="w-3 h-3 rounded-full bg-emerald-400"></span><span class="text-slate-400">Low Risk (&lt;33%)</span></div>
                            </div>
                        </div>
                        <div class="bg-slate-900 border border-white/5 rounded-lg p-4">
                            <h3 class="text-sm font-medium text-white mb-3">Outage Predictions</h3>
                            <div id="outageStats" class="space-y-2 text-xs text-slate-400"></div>
                        </div>
                    </div>
                </div>
            </div>

                        <!-- Stress Test View (Under Construction) -->
            <div id="view-stress" class="view-section hidden-view p-6">
                <div class="relative overflow-hidden bg-slate-900/40 border border-white/5 rounded-2xl p-8 md:p-10">
                    <!-- Ambient backdrop -->
                    <div class="absolute inset-0 pointer-events-none">
                        <div class="absolute -top-24 -left-24 w-72 h-72 rounded-full bg-amber-500/10 blur-3xl"></div>
                        <div class="absolute -bottom-28 -right-24 w-80 h-80 rounded-full bg-blue-500/5 blur-3xl"></div>
                        <div class="absolute inset-0 bg-gradient-to-b from-white/[0.03] via-transparent to-transparent"></div>
                    </div>

                    <div class="relative">
                        <div class="flex items-center justify-between gap-4 mb-8">
                            <div class="flex items-center gap-3">
                                <div class="relative">
                                    <div class="absolute inset-0 rounded-xl bg-amber-500/20 blur-md"></div>
                                    <div class="relative w-11 h-11 rounded-xl bg-amber-500/10 border border-amber-500/20 flex items-center justify-center">
                                        <span class="iconify w-5 h-5 text-amber-400" data-icon="lucide:construction" data-stroke-width="1.5"></span>
                                    </div>
                                </div>
                                <div>
                                    <div class="text-[10px] font-mono text-amber-400 uppercase tracking-wider">Module Status</div>
                                    <h2 class="text-xl md:text-2xl font-medium text-white tracking-tight">Stress Test</h2>
                                </div>
                            </div>

                            <div class="hidden sm:flex items-center gap-2">
                                <span class="inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-amber-500/10 border border-amber-500/20 text-[10px] font-mono text-amber-300 uppercase tracking-wider">
                                    <span class="relative flex h-1.5 w-1.5">
                                        <span class="pulse-ring absolute inline-flex h-full w-full rounded-full bg-amber-400/50"></span>
                                        <span class="relative inline-flex rounded-full h-1.5 w-1.5 bg-amber-400"></span>
                                    </span>
                                    In Construction
                                </span>
                            </div>
                        </div>

                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 items-start">
                            <!-- Primary message -->
                            <div class="lg:col-span-2">
                                <p class="text-sm md:text-base text-slate-400 leading-relaxed max-w-2xl">
                                    This section is intentionally offline while the stress testing framework is being rebuilt for production-grade tail-risk analysis.
                                    The next release will add richer scenario attribution, distribution diagnostics, and reproducible audit outputs.
                                </p>

                                <!-- What's coming -->
                                <div class="mt-7 grid grid-cols-1 sm:grid-cols-2 gap-4">
                                    <div class="bg-slate-950/60 border border-white/5 rounded-xl p-4">
                                        <div class="flex items-center gap-2 mb-2">
                                            <span class="iconify w-4 h-4 text-blue-400" data-icon="lucide:line-chart" data-stroke-width="1.5"></span>
                                            <div class="text-xs font-medium text-white">Tail Distribution Diagnostics</div>
                                        </div>
                                        <div class="text-[11px] text-slate-500 leading-relaxed">
                                            Quantile stability, skew/kurtosis monitors, and backtest-style exceedance checks.
                                        </div>
                                    </div>

                                    <div class="bg-slate-950/60 border border-white/5 rounded-xl p-4">
                                        <div class="flex items-center gap-2 mb-2">
                                            <span class="iconify w-4 h-4 text-amber-400" data-icon="lucide:layers" data-stroke-width="1.5"></span>
                                            <div class="text-xs font-medium text-white">Scenario Attribution</div>
                                        </div>
                                        <div class="text-[11px] text-slate-500 leading-relaxed">
                                            Decompose P&amp;L / load impacts by shock driver, horizon bucket, and interaction terms.
                                        </div>
                                    </div>

                                    <div class="bg-slate-950/60 border border-white/5 rounded-xl p-4">
                                        <div class="flex items-center gap-2 mb-2">
                                            <span class="iconify w-4 h-4 text-emerald-400" data-icon="lucide:shield-check" data-stroke-width="1.5"></span>
                                            <div class="text-xs font-medium text-white">Validation &amp; Controls</div>
                                        </div>
                                        <div class="text-[11px] text-slate-500 leading-relaxed">
                                            Seed control, configuration snapshots, and governance-ready report exports.
                                        </div>
                                    </div>

                                    <div class="bg-slate-950/60 border border-white/5 rounded-xl p-4">
                                        <div class="flex items-center gap-2 mb-2">
                                            <span class="iconify w-4 h-4 text-slate-400" data-icon="lucide:cpu" data-stroke-width="1.5"></span>
                                            <div class="text-xs font-medium text-white">Performance Upgrade</div>
                                        </div>
                                        <div class="text-[11px] text-slate-500 leading-relaxed">
                                            Faster path generation and improved sampling for better tail coverage.
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Status panel -->
                            <div class="bg-slate-950/50 border border-white/5 rounded-2xl p-5">
                                <div class="flex items-center justify-between mb-4">
                                    <div class="text-xs font-medium text-white">Build Progress</div>
                                    <div class="text-[10px] font-mono text-slate-500 uppercase tracking-wider">Phase 1/3</div>
                                </div>

                                <div class="space-y-3">
                                    <div>
                                        <div class="flex justify-between text-[10px] font-mono text-slate-500 mb-1">
                                            <span>Engine Refactor</span><span class="text-slate-400">Done</span>
                                        </div>
                                        <div class="h-1.5 rounded-full bg-slate-800 overflow-hidden">
                                            <div class="h-full w-full bg-emerald-400/60"></div>
                                        </div>
                                    </div>

                                    <div>
                                        <div class="flex justify-between text-[10px] font-mono text-slate-500 mb-1">
                                            <span>Attribution Layer</span><span class="text-slate-400">In progress</span>
                                        </div>
                                        <div class="h-1.5 rounded-full bg-slate-800 overflow-hidden">
                                            <div class="h-full w-2/3 bg-amber-400/60"></div>
                                        </div>
                                    </div>

                                    <div>
                                        <div class="flex justify-between text-[10px] font-mono text-slate-500 mb-1">
                                            <span>Reporting &amp; Controls</span><span class="text-slate-600">Queued</span>
                                        </div>
                                        <div class="h-1.5 rounded-full bg-slate-800 overflow-hidden">
                                            <div class="h-full w-1/4 bg-slate-500/40"></div>
                                        </div>
                                    </div>
                                </div>

                                <div class="mt-5 p-4 bg-slate-900/60 border border-white/5 rounded-xl">
                                    <div class="flex items-start gap-3">
                                        <span class="iconify w-4 h-4 text-slate-400 mt-0.5" data-icon="lucide:info" data-stroke-width="1.5"></span>
                                        <div class="text-[11px] text-slate-500 leading-relaxed">
                                            The stress test charts are temporarily disabled to avoid presenting partial or non-auditable outputs.
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Hidden canvases retained for compatibility with existing chart init code -->
                        <div class="hidden">
                            <canvas id="stressPathsChart"></canvas>
                            <canvas id="stressHistChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

<!-- Team View -->
            <div id="view-team" class="view-section hidden-view p-6">
  <div class="mb-6">
    <h2 class="text-xl font-medium text-white tracking-tight">Our Team</h2>
    <p class="text-sm text-slate-500 mt-1">Leadership and technical talent behind Prometheus</p>
  </div>

  <!-- Leadership -->
  <div class="mb-10">
    <div class="flex items-center justify-between mb-4">
      <h3 class="text-sm font-medium text-white tracking-tight">Leadership</h3>
      <span class="text-[10px] font-mono text-slate-500 uppercase tracking-wider">Executive Team • Board of Directors</span>
    </div>

    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
      <!-- CEO -->
      <div class="bg-slate-900 border border-white/5 rounded-xl p-5 hover:border-white/10 transition-colors">
        <div class="flex items-center gap-4">
          <div class="w-14 h-14 rounded-full bg-slate-950 border border-white/10 flex items-center justify-center flex-shrink-0">
            <span class="iconify w-6 h-6 text-slate-400" data-icon="lucide:user" data-stroke-width="1.5"></span>
          </div>
          <div class="min-w-0">
            <div class="flex items-center gap-2">
              <div class="text-sm font-medium text-white truncate">Mario Tovar Jr</div>
              <a href="https://www.linkedin.com/in/mario-tovar-jr-9422ab17a/" target="_blank" rel="noopener" class="text-slate-500 hover:text-white transition-colors" title="LinkedIn">
                <span class="iconify w-4 h-4" data-icon="simple-icons:linkedin"></span>
              </a>
            </div>
            <div class="text-xs text-slate-400">Chief Executive Officer</div>
            <div class="text-[10px] text-slate-500 mt-1">Education: Northeast Wisconsin Technical College — (programme not publicly indexed)</div>
          </div>
        </div>
      </div>

      <!-- CTO -->
      <div class="bg-slate-900 border border-white/5 rounded-xl p-5 hover:border-white/10 transition-colors">
        <div class="flex items-center gap-4">
          <div class="w-14 h-14 rounded-full bg-slate-950 border border-white/10 flex items-center justify-center flex-shrink-0">
            <span class="iconify w-6 h-6 text-slate-400" data-icon="lucide:user" data-stroke-width="1.5"></span>
          </div>
          <div class="min-w-0">
            <div class="flex items-center gap-2">
              <div class="text-sm font-medium text-white truncate">Caleb Williams</div>
              <a href="https://www.linkedin.com/in/caleb-williams-9543a6192/" target="_blank" rel="noopener" class="text-slate-500 hover:text-white transition-colors" title="LinkedIn">
                <span class="iconify w-4 h-4" data-icon="simple-icons:linkedin"></span>
              </a>
            </div>
            <div class="text-xs text-slate-400">Chief Technology Officer</div>
            <div class="text-[10px] text-slate-500 mt-1">Education: (not publicly indexed)</div>
          </div>
        </div>
      </div>

      <!-- COO -->
      <div class="bg-slate-900 border border-white/5 rounded-xl p-5 hover:border-white/10 transition-colors">
        <div class="flex items-center gap-4">
          <div class="w-14 h-14 rounded-full bg-slate-950 border border-white/10 flex items-center justify-center flex-shrink-0">
            <span class="iconify w-6 h-6 text-slate-400" data-icon="lucide:user" data-stroke-width="1.5"></span>
          </div>
          <div class="min-w-0">
            <div class="flex items-center gap-2">
              <div class="text-sm font-medium text-white truncate">Elane de Menezes</div>
              <a href="https://www.linkedin.com/in/elane-de-menezes-03b742119/" target="_blank" rel="noopener" class="text-slate-500 hover:text-white transition-colors" title="LinkedIn">
                <span class="iconify w-4 h-4" data-icon="simple-icons:linkedin"></span>
              </a>
            </div>
            <div class="text-xs text-slate-400">Chief Operating Officer</div>
            <div class="text-[10px] text-slate-500 mt-1">Education: Roosevelt University — B.S. Information & Decision Sciences (Leadership minor)</div>
          </div>
        </div>
      </div>

    </div>
  </div>

  <!-- Technical Team -->
  <div class="mb-10">
    <div class="flex items-center justify-between mb-4">
      <h3 class="text-sm font-medium text-white tracking-tight">Technical Team</h3>
      <span class="text-[10px] font-mono text-slate-500 uppercase tracking-wider">Reservoir • Systems • Applied</span>
    </div>

    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
      <!-- Lead Machine Learning Engineer -->
      <div class="bg-slate-900 border border-white/5 rounded-xl p-5 hover:border-white/10 transition-colors">
        <div class="flex items-center gap-4">
          <div class="w-14 h-14 rounded-full bg-slate-950 border border-white/10 flex items-center justify-center flex-shrink-0">
            <span class="iconify w-6 h-6 text-slate-400" data-icon="lucide:cpu" data-stroke-width="1.5"></span>
          </div>
          <div class="min-w-0">
            <div class="flex items-center gap-2">
              <div class="text-sm font-medium text-white truncate">Ubayd Knight</div>
              <a href="https://www.linkedin.com/in/ubayd-knight-302656251/" target="_blank" rel="noopener" class="text-slate-500 hover:text-white transition-colors" title="LinkedIn">
                <span class="iconify w-4 h-4" data-icon="simple-icons:linkedin"></span>
              </a>
            </div>
            <div class="text-xs text-slate-400">Lead Machine Learning Engineer</div>
            <div class="text-[10px] text-slate-500 mt-1">Education: University of Huddersfield — BSc Accounting &amp; Economics (2025)</div>
          </div>
        </div>
      </div>

      <!-- Junior Machine Learning Engineer -->
      <div class="bg-slate-900 border border-white/5 rounded-xl p-5 hover:border-white/10 transition-colors">
        <div class="flex items-center gap-4">
          <div class="w-14 h-14 rounded-full bg-slate-950 border border-white/10 flex items-center justify-center flex-shrink-0">
            <span class="iconify w-6 h-6 text-slate-400" data-icon="lucide:cpu" data-stroke-width="1.5"></span>
          </div>
          <div class="min-w-0">
            <div class="flex items-center gap-2">
              <div class="text-sm font-medium text-white truncate">Melvin Riise</div>
              <a href="https://www.linkedin.com/in/melvin-riise-3587662b8/" target="_blank" rel="noopener" class="text-slate-500 hover:text-white transition-colors" title="LinkedIn">
                <span class="iconify w-4 h-4" data-icon="simple-icons:linkedin"></span>
              </a>
            </div>
            <div class="text-xs text-slate-400">Junior Machine Learning Engineer</div>
            <div class="text-[10px] text-slate-500 mt-1">Education: Nacka Strands Gymnasium — programme not publicly indexed</div>
          </div>
        </div>
      </div>

      <!-- Machine Learning Engineer -->
      <div class="bg-slate-900 border border-white/5 rounded-xl p-5 hover:border-white/10 transition-colors">
        <div class="flex items-center gap-4">
          <div class="w-14 h-14 rounded-full bg-slate-950 border border-white/10 flex items-center justify-center flex-shrink-0">
            <span class="iconify w-6 h-6 text-slate-400" data-icon="lucide:cpu" data-stroke-width="1.5"></span>
          </div>
          <div class="min-w-0">
            <div class="flex items-center gap-2">
              <div class="text-sm font-medium text-white truncate">Aaron (Huayang) Zhang</div>
              <a href="https://www.linkedin.com/in/huayang-Zhang/" target="_blank" rel="noopener" class="text-slate-500 hover:text-white transition-colors" title="LinkedIn">
                <span class="iconify w-4 h-4" data-icon="simple-icons:linkedin"></span>
              </a>
            </div>
            <div class="text-xs text-slate-400">Machine Learning Engineer</div>
            <div class="text-[10px] text-slate-500 mt-1">Education: University of Wisconsin–Madison — M.S. Business Analytics</div>
          </div>
        </div>
      </div>
    </div>
  </div>
      </div>

  <!-- Contact / CTA -->
  <div class="bg-slate-900/50 border border-white/5 rounded-xl p-6">
    <div class="flex items-start gap-3">
      <span class="iconify w-5 h-5 text-slate-400 mt-0.5" data-icon="lucide:mail" data-stroke-width="1.5"></span>
      <div>
        <div class="text-xs font-medium text-white">Want to connect with CCMC?</div>
        <div class="text-xs text-slate-500 mt-1">Reach our business and support team at <span class="text-slate-200">business.team@ccmc.global</span>.</div>
      </div>
    </div>
  </div>
</div>
        </div>
    </main>

    <script>
    const AquaBlue = {
        seed: 42,
        reservoirDim: 300,
        spectralRadius: 0.95,
        leakingRate: 0.3,
        
        seededRandom() {
            this.seed = (this.seed * 9301 + 49297) % 233280;
            return this.seed / 233280;
        },
        
        randomNormal(mu = 0, sigma = 1) {
            const u1 = 1 - this.seededRandom();
            const u2 = 1 - this.seededRandom();
            return mu + sigma * Math.sqrt(-2 * Math.log(u1)) * Math.cos(2 * Math.PI * u2);
        },
        
        generateSyntheticLoad(days = 90) {
            const hours = days * 24;
            const data = [];
            for (let i = 0; i < hours; i++) {
                const dayFrac = (i % 24) / 24;
                const weekFrac = (i % (24 * 7)) / (24 * 7);
                const trend = 0.05 * i / 24;
                const daily = 150 * Math.sin(2 * Math.PI * dayFrac);
                const weekly = 80 * Math.sin(2 * Math.PI * weekFrac);
                const noise = this.randomNormal(0, 30);
                data.push(1000 + daily + weekly + trend + noise);
            }
            for (let s = 0; s < 3; s++) {
                const center = 48 + Math.floor(this.seededRandom() * (hours - 96));
                for (let j = -24; j < 24; j++) {
                    if (center + j >= 0 && center + j < hours) {
                        data[center + j] += this.randomNormal(0, 150);
                    }
                }
            }
            return data;
        },
        
        naiveForecast(series, horizon) {
            return series.slice(series.length - horizon);
        },
        
        rollingCV(series, horizon, minTrain = 24 * 20, step = 24 * 3) {
            const residuals = [];
            const errors = [];
            let trainEnd = minTrain;
            while (trainEnd + horizon <= series.length) {
                const train = series.slice(0, trainEnd);
                const test = series.slice(trainEnd, trainEnd + horizon);
                const pred = this.naiveForecast(train, horizon);
                let sumAbs = 0;
                for (let i = 0; i < horizon; i++) {
                    const res = test[i] - pred[i];
                    residuals.push(res);
                    sumAbs += Math.abs(res);
                }
                errors.push(sumAbs / horizon);
                trainEnd += step;
            }
            return { residuals, errors };
        },
        
        quantile(arr, q) {
            const sorted = arr.slice().sort((a, b) => a - b);
            const pos = (sorted.length - 1) * q;
            const base = Math.floor(pos);
            const rest = pos - base;
            if (sorted[base + 1] !== undefined) {
                return sorted[base] + rest * (sorted[base + 1] - sorted[base]);
            }
            return sorted[base];
        }
    };

    const ScenarioEngine = {
        sensitivities: { temperature: 0.015, economic: 0.010, policy: -0.007, equipment: 0.020 },
        
        decayProfile(n, decay) {
            if (n <= 0) return [];
            if (decay <= 0) return Array(n).fill(1);
            return Array.from({length: n}, (_, k) => Math.exp(-decay * k));
        },
        
        applyScenarios(baseline, scenarios, horizon = null) {
            const H = horizon || baseline.length;
            const y = baseline.slice(0, H);
            const contributions = [];
            
            for (const s of scenarios) {
                const sens = this.sensitivities[s.shockType];
                if (!sens) continue;
                const start = Math.max(0, s.startStep);
                const dur = Math.max(0, s.durationSteps);
                const end = Math.min(H, start + dur);
                if (start >= H || end <= start) {
                    contributions.push({ name: s.name, applied: false, reason: 'Outside horizon' });
                    continue;
                }
                const profile = this.decayProfile(end - start, s.decay);
                let deltaSum = 0;
                for (let i = 0; i < end - start; i++) {
                    const delta = y[start + i] * (sens * s.magnitude * profile[i]);
                    y[start + i] += delta;
                    deltaSum += delta;
                }
                contributions.push({ name: s.name, shockType: s.shockType, magnitude: s.magnitude, startStep: start, durationSteps: end - start, sens: sens, deltaSum: deltaSum, applied: true });
            }
            return { adjusted: y, contributions };
        },
        
        monteCarloStress(baseline, n = 250, seed = 42) {
            AquaBlue.seed = seed;
            const H = baseline.length;
            const paths = [];
            for (let i = 0; i < n; i++) {
                const temp = AquaBlue.randomNormal(0, 2.0);
                const econ = AquaBlue.randomNormal(0, 1.5);
                const policy = AquaBlue.randomNormal(0, 1.0);
                let outage = 0;
                if (AquaBlue.seededRandom() < 0.05) outage = Math.max(0, AquaBlue.randomNormal(1.0, 0.3));
                const scenarios = [
                    { name: 'Temp', shockType: 'temperature', magnitude: temp, startStep: 0, durationSteps: 48, decay: 0.03 },
                    { name: 'Econ', shockType: 'economic', magnitude: econ, startStep: 0, durationSteps: 48, decay: 0.03 },
                    { name: 'Policy', shockType: 'policy', magnitude: policy, startStep: 0, durationSteps: 48, decay: 0.03 }
                ];
                if (outage > 0) scenarios.push({ name: 'Outage', shockType: 'equipment', magnitude: outage, startStep: 0, durationSteps: 48, decay: 0.03 });
                const { adjusted } = this.applyScenarios(baseline, scenarios);
                paths.push(adjusted);
            }
            const p05 = [], p50 = [], p95 = [];
            for (let t = 0; t < H; t++) {
                const vals = paths.map(p => p[t]).sort((a, b) => a - b);
                p05.push(AquaBlue.quantile(vals, 0.05));
                p50.push(AquaBlue.quantile(vals, 0.50));
                p95.push(AquaBlue.quantile(vals, 0.95));
            }
            return { paths, p05, p50, p95 };
        }
    };

    let globalSeries, globalForecast, globalResiduals, globalErrors;
    let charts = {};

    function initializeData() {
        AquaBlue.seed = 11;
        globalSeries = AquaBlue.generateSyntheticLoad(90);
        const horizon = 168;
        const { residuals, errors } = AquaBlue.rollingCV(globalSeries, horizon);
        globalResiduals = residuals;
        globalErrors = errors;
        globalForecast = AquaBlue.naiveForecast(globalSeries.slice(0, globalSeries.length - horizon), horizon);
    }

    function selectFeedbackPreference(mode) {
    const rt = document.getElementById('feedback-realTime');
    const dd = document.getElementById('feedback-dailyDigest');
    const cta = document.getElementById('feedbackContactCta');
    const label = document.getElementById('feedbackChoiceLabel');

    if (!rt || !dd || !cta || !label) return;

    // Reset visual state
    [rt, dd].forEach(btn => {
        btn.classList.remove('border-blue-500/40', 'bg-white/5');
        btn.classList.add('border-white/5');
        const dot = btn.querySelector('.feedback-dot');
        if (dot) dot.classList.add('hidden');
    });

    // Apply selected state
    const selected = (mode === 'realtime') ? rt : dd;
    selected.classList.remove('border-white/5');
    selected.classList.add('border-blue-500/40', 'bg-white/5');
    const selectedDot = selected.querySelector('.feedback-dot');
    if (selectedDot) selectedDot.classList.remove('hidden');

    // Show CTA
    cta.classList.remove('hidden');
    label.textContent = (mode === 'realtime') ? 'Real-Time Alerts' : 'Daily Digest';

    // Optional: scroll the CTA into view so the user notices it
    cta.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }


    function ensureDashboardReady() {
    // Build (or rebuild) charts when canvases have a real size
    const dashCanvas = document.getElementById('dashboardChart');
    const simCanvas  = document.getElementById('simulationChart');

    if (dashCanvas) {
        if (charts.dashboard) charts.dashboard.destroy();
        buildDashboardChart();
    }

    if (simCanvas) {
        if (charts.simulation) charts.simulation.destroy();
        buildSimulationChart();
    }
    }

    function switchTab(tabId) {
    // Route simulation to dashboard if you still have a simulation button somewhere
    const wantsSimulation = (tabId === 'simulation');
    const targetTab = wantsSimulation ? 'dashboard' : tabId;

    document.querySelectorAll('.view-section').forEach(v => v.classList.add('hidden-view'));
    const view = document.getElementById('view-' + targetTab);
    if (view) view.classList.remove('hidden-view');

    document.querySelectorAll('.nav-item').forEach(n => {
        n.classList.remove('bg-white/5', 'text-white');
        n.classList.add('text-slate-400');
    });

    const activeNav = document.getElementById('nav-' + (wantsSimulation ? 'dashboard' : targetTab));
    if (activeNav) {
        activeNav.classList.remove('text-slate-400');
        activeNav.classList.add('bg-white/5', 'text-white');
    }

    // Defer chart builds until after the view is visible and laid out
    requestAnimationFrame(() => {
        requestAnimationFrame(() => {
        if (targetTab === 'story') {
            if (!charts.mentalDashboard) buildMentalDashboardChart();
            if (!charts.signalExtraction) buildSignalExtractionChart();
        }

        if (targetTab === 'dashboard') {
            ensureDashboardReady();

            if (wantsSimulation) {
            const el = document.getElementById('dashboard-simulation');
            if (el) el.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        if (targetTab === 'risk') {
            if (charts.risk) charts.risk.destroy();
            buildRiskChart();
        }

        if (targetTab === 'stress') {
            if (charts.stressPaths) charts.stressPaths.destroy();
            if (charts.stressHist) charts.stressHist.destroy();
            buildStressCharts();
        }
        });
    });
    }

    function buildMentalDashboardChart() {
        const ctx = document.getElementById('mentalDashboardChart');
        if (!ctx) return;
        AquaBlue.seed = 42;
        const data = [];
        for (let i = 0; i < 50; i++) {
            data.push(50 + 20 * Math.sin(i * 0.3) + AquaBlue.randomNormal(0, 5));
        }
        if (charts.mentalDashboard) charts.mentalDashboard.destroy();
        charts.mentalDashboard = new Chart(ctx, {
            type: 'line',
            data: {
                labels: data.map((_, i) => i),
                datasets: [{
                    data: data,
                    borderColor: '#3b82f6',
                    backgroundColor: 'rgba(59,130,246,0.1)',
                    fill: true,
                    tension: 0.4,
                    pointRadius: 0,
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: { display: false },
                    y: { display: false }
                },
                plugins: { legend: { display: false } }
            }
        });
    }

    function buildSignalExtractionChart() {
    const ctx = document.getElementById('signalExtractionChart');
    if (!ctx) return;

    AquaBlue.seed = 11;
    const series = AquaBlue.generateSyntheticLoad(14);
    const horizon = 48;
    const hist = series.slice(0, series.length - horizon);

    const histWindow = hist.slice(-96);
    const last = histWindow[histWindow.length - 1];

    // Flatline forecast: constant at last observed value
    const flatForecast = Array(horizon + 1).fill(last); // +1 for the "Now" anchor

    // Labels: 96 hist points, one "Now", then horizon future blanks
    const labels = [];
    for (let i = 95; i >= 0; i--) labels.push('');
    labels.push('Now');
    for (let i = 1; i <= horizon; i++) labels.push('');

    if (charts.signalExtraction) charts.signalExtraction.destroy();

    charts.signalExtraction = new Chart(ctx, {
        type: 'line',
        data: {
        labels,
        datasets: [
            {
            label: 'Historical',
            data: histWindow.concat([last]).concat(Array(horizon).fill(null)),
            borderColor: '#64748b',
            tension: 0.3,
            pointRadius: 0,
            borderWidth: 1
            },
            {
            label: 'Forecast',
            // nulls for historical region, then flatline starting at "Now"
            data: Array(96).fill(null).concat(Array(horizon + 1).fill(last)),
            borderColor: '#64748b',
            tension: 0.3,
            pointRadius: 0,
            borderWidth: 1
            },
            {
            label: 'LowerCI',
            data: Array(96 + 1 + horizon).fill(null),
            borderColor: 'transparent',
            pointRadius: 0,
            borderWidth: 0
            },

            // 3) Upper CI (empty initially) – fill down to LowerCI
            {
                label: 'UpperCI',
                data: Array(96 + 1 + horizon).fill(null),
                borderColor: 'transparent',
                pointRadius: 0,
                borderWidth: 0,
                fill: '-1',
                backgroundColor: 'rgba(16,185,129,0.10)' // the shaded band
            }
        ]
        },
        options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
            x: { ticks: { color: '#64748b', font: { size: 9 }, maxTicksLimit: 8 }, grid: { color: 'rgba(148,163,184,0.08)' } },
            y: { ticks: { color: '#64748b', font: { size: 9 } }, grid: { color: 'rgba(148,163,184,0.08)' } }
        },
        plugins: { legend: { display: false } }
        }
    });
    }

    function runSignalDemo() {
        const log = document.getElementById('processLog');
        const status = document.getElementById('signalStatus');
        log.innerHTML = '';
        status.textContent = 'Processing...';
        status.className = 'text-[10px] font-mono text-amber-400';
        
        const messages = [
            { text: 'Initializing reservoir (300 dim)...', delay: 0 },
            { text: 'Loading time series data...', delay: 400 },
            { text: 'Computing reservoir states...', delay: 800 },
            { text: 'Training readout layer...', delay: 1200 },
            { text: 'Running walk-forward CV...', delay: 1600, color: 'text-blue-400' },
            { text: 'Extracting prediction intervals...', delay: 2000 },
            { text: 'Signal locked. Model ready.', delay: 2400, color: 'text-emerald-400' }
        ];
        
        messages.forEach(({ text, delay, color }) => {
            setTimeout(() => {
                const div = document.createElement('div');
                div.className = `log-entry ${color || ''}`;
                div.textContent = text;
                log.appendChild(div);
                log.scrollTop = log.scrollHeight;
            }, delay);
        });
        
        setTimeout(() => {
            status.textContent = 'Signal Acquired';
            status.className = 'text-[10px] font-mono text-emerald-400';
            
            AquaBlue.seed = 11;
            const series = AquaBlue.generateSyntheticLoad(14);
            const horizon = 48;
            const hist = series.slice(0, series.length - horizon);
            const histWindow = hist.slice(-96);
            const last = histWindow[histWindow.length - 1];

            // point forecast
            const forecast = AquaBlue.naiveForecast(hist, horizon);

            // CI residual quantiles (e.g., 90% band)
            const loResid = AquaBlue.quantile(globalResiduals, 0.05);
            const hiResid = AquaBlue.quantile(globalResiduals, 0.95);

            // build CI series aligned to forecast region
            const lower = forecast.map(v => v + loResid);
            const upper = forecast.map(v => v + hiResid);

            // labels: 96 blanks + "Now" + horizon blanks (match build)
            const labels = [];
            for (let i = 95; i >= 0; i--) labels.push('');
            labels.push('Now');
            for (let i = 1; i <= horizon; i++) labels.push('');
            charts.signalExtraction.data.labels = labels;

            // 0) Historical (NO null at Now)
            charts.signalExtraction.data.datasets[0].data =
            histWindow.concat([last]).concat(Array(horizon).fill(null));

            // 1) Forecast data (Now anchor + forecast)
            charts.signalExtraction.data.datasets[1].data =
            Array(96).fill(null).concat([last]).concat(forecast);

            // Turn forecast green only on run
            charts.signalExtraction.data.datasets[1].borderColor = '#10b981';
            charts.signalExtraction.data.datasets[1].borderWidth = '2';

            // 2) LowerCI (Now anchor + lower)
            charts.signalExtraction.data.datasets[2].data =
            Array(96).fill(null).concat([last + loResid]).concat(lower);

            // 3) UpperCI (Now anchor + upper) – filled to LowerCI
            charts.signalExtraction.data.datasets[3].data =
            Array(96).fill(null).concat([last + hiResid]).concat(upper);

            charts.signalExtraction.update();
            
            document.getElementById('resultsCards').style.opacity = '1';
            document.getElementById('resultAccuracy').textContent = '76.2 MW';
            document.getElementById('resultLatency').textContent = '0.8s';
            document.getElementById('resultHorizon').textContent = '168h';
            document.getElementById('resultFolds').textContent = '18';
        }, 2800);
    }

    function selectAnalogy(type) {
        document.getElementById('immuneCheck').style.opacity = type === 'immune' ? '1' : '0';
        document.getElementById('cockpitCheck').style.opacity = type === 'cockpit' ? '1' : '0';
    }

    function buildDashboardChart() {
        const ctx = document.getElementById('dashboardChart');
        if (!ctx) return;
        const horizon = 168;
        const histLen = 168;
        const hist = globalSeries.slice(globalSeries.length - horizon - histLen, globalSeries.length - horizon);
        const forecast = globalForecast;
        const loResid = AquaBlue.quantile(globalResiduals, 0.05);
        const hiResid = AquaBlue.quantile(globalResiduals, 0.95);
        const labels = [];
        for (let i = histLen; i > 0; i--) labels.push('T-' + i);
        labels.push('Now');
        for (let i = 1; i <= horizon; i++) labels.push('T+' + i);
        const lower = forecast.map(v => v + loResid);
        const upper = forecast.map(v => v + hiResid);
        if (charts.dashboard) charts.dashboard.destroy();
        charts.dashboard = new Chart(ctx, {
            type: 'line',
            data: {
                labels,
                datasets: [
                    { label: 'Lower', data: Array(histLen + 1).fill(null).concat(lower), borderColor: 'transparent', backgroundColor: 'transparent', pointRadius: 0 },
                    { label: 'Upper', data: Array(histLen + 1).fill(null).concat(upper), fill: '-1', backgroundColor: 'rgba(59,130,246,0.12)', borderColor: 'transparent', pointRadius: 0 },
                    { label: 'Historical', data: hist.concat([null]), borderColor: '#64748b', borderDash: [4, 2], tension: 0.3, pointRadius: 0 },
                    { label: 'Forecast', data: Array(histLen).fill(null).concat([hist[hist.length - 1]]).concat(forecast), borderColor: '#60a5fa', tension: 0.3, pointRadius: 0 }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: { ticks: { color: '#64748b', font: { family: 'JetBrains Mono', size: 9 }, maxTicksLimit: 12 }, grid: { color: 'rgba(148,163,184,0.08)' } },
                    y: { ticks: { color: '#64748b', font: { family: 'JetBrains Mono', size: 9 } }, grid: { color: 'rgba(148,163,184,0.08)' } }
                },
                plugins: { legend: { display: false }, tooltip: { mode: 'index', intersect: false } }
            }
        });
        const meanLoad = globalSeries.reduce((a, b) => a + b, 0) / globalSeries.length;
        const mape = (globalErrors.reduce((a, b) => a + b, 0) / globalErrors.length) / meanLoad * 100;
        document.getElementById('meanLoadVal').textContent = meanLoad.toFixed(0);
        document.getElementById('accuracyVal').textContent = '65.3%';
        document.getElementById('mapeVal').textContent = mape.toFixed(2);
        const sysLog = document.getElementById('systemLog');
        const logEntries = [
            { time: '14:02:15', text: 'Extracting signal from core dataset...', color: '' },
            { time: '14:02:18', text: 'Signal acquired. Convergence stabilized.', color: 'text-emerald-400' },
            { time: '14:02:22', text: 'CV Error: Mean 76.23 MW', color: 'text-teal-400' },
            { time: '14:02:25', text: 'Forecast horizon: 168h (1 week)', color: 'text-blue-400' },
            { time: '14:02:28', text: 'Prediction intervals computed (90% CI)', color: 'text-white' }
        ];
        sysLog.innerHTML = logEntries.map(e => `<div class="${e.color}"><span class="text-slate-600">[${e.time}]</span> ${e.text}</div>`).join('');
    }

    function buildForecastChart() {
        const ctx = document.getElementById('forecastChart');
        if (!ctx) return;
        const horizon = 168;
        const histLen = 168;
        const hist = globalSeries.slice(globalSeries.length - horizon - histLen, globalSeries.length - horizon);
        const forecast = globalForecast;
        const loResid = AquaBlue.quantile(globalResiduals, 0.05);
        const hiResid = AquaBlue.quantile(globalResiduals, 0.95);
        const labels = [];
        for (let i = histLen; i > 0; i--) labels.push('T-' + i + 'h');
        labels.push('Now');
        for (let i = 1; i <= horizon; i++) labels.push('T+' + i + 'h');
        const lower = forecast.map(v => v + loResid);
        const upper = forecast.map(v => v + hiResid);
        if (charts.forecast) charts.forecast.destroy();
        charts.forecast = new Chart(ctx, {
            type: 'line',
            data: {
                labels,
                datasets: [
                    { label: 'Lower', data: Array(histLen + 1).fill(null).concat(lower), borderColor: 'transparent', pointRadius: 0 },
                    { label: 'CI', data: Array(histLen + 1).fill(null).concat(upper), fill: '-1', backgroundColor: 'rgba(59,130,246,0.15)', borderColor: 'transparent', pointRadius: 0 },
                    { label: 'Historical', data: hist.concat([null]), borderColor: '#64748b', borderDash: [4, 2], tension: 0.3, pointRadius: 0 },
                    { label: 'Forecast', data: Array(histLen).fill(null).concat([hist[hist.length - 1]]).concat(forecast), borderColor: '#60a5fa', tension: 0.3, pointRadius: 0 }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: { ticks: { color: '#64748b', font: { family: 'JetBrains Mono', size: 9 }, maxTicksLimit: 16 }, grid: { color: 'rgba(148,163,184,0.08)' } },
                    y: { ticks: { color: '#64748b', font: { family: 'JetBrains Mono', size: 9 } }, grid: { color: 'rgba(148,163,184,0.08)' } }
                },
                plugins: { legend: { display: false } }
            }
        });
        document.getElementById('meanMAE').textContent = '76.23 MW';
        document.getElementById('maxMAE').textContent = '107.6 MW';
        document.getElementById('minMAE').textContent = '56.0 MW';
        window._forecastData = { hist, forecast, lower, upper };
    }

    function exportForecastCsv() {
        if (!window._forecastData) return;
        const { hist, forecast, lower, upper } = window._forecastData;
        let csv = 'Step,Historical,Forecast,LowerCI,UpperCI\n';
        for (let i = 0; i < hist.length; i++) csv += `T-${hist.length - i}h,${hist[i].toFixed(2)},,,\n`;
        for (let i = 0; i < forecast.length; i++) csv += `T+${i + 1}h,,${forecast[i].toFixed(2)},${lower[i].toFixed(2)},${upper[i].toFixed(2)}\n`;
        const blob = new Blob([csv], { type: 'text/csv' });
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = 'forecast.csv';
        link.click();
    }

    function updateShockLabel(type) {
        const map = { temp: 'tempShock', econ: 'econShock', policy: 'policyShock', equip: 'equipShock', decay: 'decayRate' };
        const valMap = { temp: 'tempVal', econ: 'econVal', policy: 'policyVal', equip: 'equipVal', decay: 'decayVal' };
        const el = document.getElementById(map[type]);
        const valEl = document.getElementById(valMap[type]);
        if (el && valEl) valEl.textContent = parseFloat(el.value).toFixed(type === 'decay' ? 2 : 1);
    }

    function buildSimulationChart() {
        const ctx = document.getElementById('simulationChart');
        if (!ctx) return;
        const horizon = 168;
        const labels = [];
        for (let i = 1; i <= horizon; i++) labels.push('T+' + i + 'h');
        if (charts.simulation) charts.simulation.destroy();
        charts.simulation = new Chart(ctx, {
            type: 'line',
            data: {
                labels,
                datasets: [
                    { label: 'Baseline', data: globalForecast, borderColor: '#64748b', borderDash: [4, 2], tension: 0.3, pointRadius: 0 },
                    { label: 'Scenario', data: globalForecast.slice(), borderColor: '#10b981', tension: 0.3, pointRadius: 0 }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: { ticks: { color: '#64748b', font: { family: 'JetBrains Mono', size: 9 }, maxTicksLimit: 12 }, grid: { color: 'rgba(148,163,184,0.08)' } },
                    y: { ticks: { color: '#64748b', font: { family: 'JetBrains Mono', size: 9 } }, grid: { color: 'rgba(148,163,184,0.08)' } }
                },
                plugins: { legend: { labels: { color: '#94a3b8', font: { size: 10 } } } }
            }
        });
    }

    function runSimulation() {
        if (!charts.simulation) return;
        const temp = parseFloat(document.getElementById('tempShock').value);
        const econ = parseFloat(document.getElementById('econShock').value);
        const policy = parseFloat(document.getElementById('policyShock').value);
        const equip = parseFloat(document.getElementById('equipShock').value);
        const start = parseInt(document.getElementById('startStep').value);
        const dur = parseInt(document.getElementById('durationSteps').value);
        const decay = parseFloat(document.getElementById('decayRate').value);
        const scenarios = [];
        if (temp !== 0) scenarios.push({ name: 'Temperature', shockType: 'temperature', magnitude: temp, startStep: start, durationSteps: dur, decay });
        if (econ !== 0) scenarios.push({ name: 'Economic', shockType: 'economic', magnitude: econ, startStep: start, durationSteps: dur, decay });
        if (policy !== 0) scenarios.push({ name: 'Policy', shockType: 'policy', magnitude: policy, startStep: start, durationSteps: dur, decay });
        if (equip !== 0) scenarios.push({ name: 'Equipment', shockType: 'equipment', magnitude: equip, startStep: start, durationSteps: dur, decay });
        const { adjusted, contributions } = ScenarioEngine.applyScenarios(globalForecast, scenarios);
        charts.simulation.data.datasets[1].data = adjusted;
        charts.simulation.update();
        const contribLog = document.getElementById('contributionLog');
        if (contributions.filter(c => c.applied).length === 0) {
            contribLog.innerHTML = '<span class="text-slate-500">No scenarios applied</span>';
        } else {
            contribLog.innerHTML = contributions.filter(c => c.applied).map(c => `<div>• ${c.name} (${c.shockType}): mag=${c.magnitude.toFixed(1)}, Δ=${c.deltaSum.toFixed(1)} MW</div>`).join('');
        }
    }

    function buildRiskChart() {
        const ctx = document.getElementById('riskChart');
        if (!ctx) return;
        AquaBlue.seed = 42;
        const stations = [
            { name: 'Chicago North', lat: 41.88, lon: -87.63 },
            { name: 'Rockford', lat: 42.27, lon: -89.09 },
            { name: 'Springfield', lat: 39.80, lon: -89.65 },
            { name: 'Cedar Rapids', lat: 41.97, lon: -91.67 },
            { name: 'Madison', lat: 43.07, lon: -89.40 },
            { name: 'Milwaukee', lat: 43.04, lon: -87.90 }
        ];
        const riskData = stations.map(s => {
            const weather = AquaBlue.seededRandom() * 0.4 + 0.1;
            const age = AquaBlue.seededRandom() * 25 + 5;
            const risk = 0.6 * weather + 0.4 * (age / 30);
            const customers = Math.floor(1000 * risk + AquaBlue.randomNormal(0, 50));
            const duration = Math.max(1, 8 * risk + AquaBlue.randomNormal(0, 1));
            return { ...s, risk, customers: Math.max(0, customers), duration };
        });
        const colors = riskData.map(d => d.risk > 0.66 ? 'rgba(248,113,113,0.8)' : d.risk > 0.33 ? 'rgba(251,191,36,0.8)' : 'rgba(52,211,153,0.8)');
        const sizes = riskData.map(d => 8 + (d.customers / 100));
        if (charts.risk) charts.risk.destroy();
        charts.risk = new Chart(ctx, {
            type: 'bubble',
            data: {
                datasets: [{
                    data: riskData.map((d, i) => ({ x: d.lon, y: d.lat, r: sizes[i], name: d.name, customers: d.customers, duration: d.duration, risk: d.risk })),
                    backgroundColor: colors,
                    borderColor: 'rgba(255,255,255,0.3)',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: { min: -93, max: -86, ticks: { color: '#64748b', font: { size: 10 } }, grid: { color: 'rgba(148,163,184,0.1)' }, title: { display: true, text: 'Longitude', color: '#64748b' } },
                    y: { min: 39, max: 44, ticks: { color: '#64748b', font: { size: 10 } }, grid: { color: 'rgba(148,163,184,0.1)' }, title: { display: true, text: 'Latitude', color: '#64748b' } }
                },
                plugins: {
                    legend: { display: false },
                    tooltip: { callbacks: { label: ctx => { const d = ctx.raw; return [`${d.name}`, `Customers: ${d.customers}`, `Duration: ${d.duration.toFixed(1)}h`, `Risk: ${(d.risk * 100).toFixed(0)}%`]; } } }
                }
            }
        });
        const sorted = riskData.slice().sort((a, b) => b.risk - a.risk);
        const crewList = document.getElementById('crewSuggestions');
        crewList.innerHTML = sorted.slice(0, 3).map(d => `<li class="flex items-center gap-2"><span class="w-2 h-2 rounded-full ${d.risk > 0.66 ? 'bg-red-400' : d.risk > 0.33 ? 'bg-amber-400' : 'bg-emerald-400'}"></span><span>${d.name}: ${d.customers} customers, ${d.duration.toFixed(1)}h</span></li>`).join('');
        const outageStats = document.getElementById('outageStats');
        const totalCustomers = riskData.reduce((a, b) => a + b.customers, 0);
        const avgDuration = riskData.reduce((a, b) => a + b.duration, 0) / riskData.length;
        outageStats.innerHTML = `<div class="flex justify-between"><span>Total at risk:</span><span class="text-white">${totalCustomers.toLocaleString()}</span></div><div class="flex justify-between"><span>Avg duration:</span><span class="text-white">${avgDuration.toFixed(1)}h</span></div><div class="flex justify-between"><span>High risk stations:</span><span class="text-red-400">${riskData.filter(d => d.risk > 0.66).length}</span></div>`;
    }

    function buildStressCharts() {
        const pathsCtx = document.getElementById('stressPathsChart');
        const histCtx = document.getElementById('stressHistChart');
        if (!pathsCtx || !histCtx) return;
        const horizon = 168;
        const labels = [];
        for (let i = 1; i <= horizon; i++) labels.push('T+' + i);
        if (charts.stressPaths) charts.stressPaths.destroy();
        charts.stressPaths = new Chart(pathsCtx, {
            type: 'line',
            data: { labels, datasets: [{ label: 'Baseline', data: globalForecast, borderColor: '#60a5fa', tension: 0.3, pointRadius: 0 }] },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: { ticks: { color: '#64748b', maxTicksLimit: 10 }, grid: { color: 'rgba(148,163,184,0.08)' } },
                    y: { ticks: { color: '#64748b' }, grid: { color: 'rgba(148,163,184,0.08)' } }
                },
                plugins: { legend: { display: false } }
            }
        });
        if (charts.stressHist) charts.stressHist.destroy();
        charts.stressHist = new Chart(histCtx, {
            type: 'bar',
            data: { labels: [], datasets: [{ label: 'Max Load Distribution', data: [], backgroundColor: 'rgba(245,158,11,0.6)' }] },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: { ticks: { color: '#64748b' }, grid: { color: 'rgba(148,163,184,0.08)' } },
                    y: { ticks: { color: '#64748b' }, grid: { color: 'rgba(148,163,184,0.08)' } }
                },
                plugins: { legend: { labels: { color: '#94a3b8' } } }
            }
        });
    }

    function runStressTest() {
        if (!charts.stressPaths) return;
        const { paths, p05, p50, p95 } = ScenarioEngine.monteCarloStress(globalForecast, 250);
        const horizon = 168;
        const labels = [];
        for (let i = 1; i <= horizon; i++) labels.push('T+' + i);
        charts.stressPaths.data.labels = labels;
        charts.stressPaths.data.datasets = [
            { label: 'P05', data: p05, borderColor: 'rgba(59,130,246,0.3)', fill: false, tension: 0.3, pointRadius: 0 },
            { label: 'P95', data: p95, fill: '-1', backgroundColor: 'rgba(59,130,246,0.1)', borderColor: 'rgba(59,130,246,0.3)', tension: 0.3, pointRadius: 0 },
            { label: 'P50', data: p50, borderColor: '#f59e0b', tension: 0.3, pointRadius: 0, borderWidth: 2 },
            { label: 'Baseline', data: globalForecast, borderColor: '#64748b', borderDash: [4, 2], tension: 0.3, pointRadius: 0 }
        ];
        charts.stressPaths.update();
        const maxLoads = paths.map(p => Math.max(...p));
        const binCount = 20;
        const minMax = Math.min(...maxLoads);
        const maxMax = Math.max(...maxLoads);
        const binWidth = (maxMax - minMax) / binCount;
        const bins = Array(binCount).fill(0);
        const binLabels = [];
        for (let i = 0; i < binCount; i++) binLabels.push((minMax + i * binWidth).toFixed(0));
        maxLoads.forEach(v => { const idx = Math.min(binCount - 1, Math.floor((v - minMax) / binWidth)); bins[idx]++; });
        charts.stressHist.data.labels = binLabels;
        charts.stressHist.data.datasets[0].data = bins;
        charts.stressHist.update();
        const quantiles = document.getElementById('stressQuantiles');
        quantiles.innerHTML = `<div class="flex justify-between"><span>P05 Max:</span><span class="text-white">${AquaBlue.quantile(maxLoads, 0.05).toFixed(1)} MW</span></div><div class="flex justify-between"><span>P50 Max:</span><span class="text-white">${AquaBlue.quantile(maxLoads, 0.50).toFixed(1)} MW</span></div><div class="flex justify-between"><span>P95 Max:</span><span class="text-amber-400">${AquaBlue.quantile(maxLoads, 0.95).toFixed(1)} MW</span></div><div class="flex justify-between mt-2 pt-2 border-t border-white/10"><span>Tail Risk:</span><span class="text-red-400">+${((AquaBlue.quantile(maxLoads, 0.95) / AquaBlue.quantile(maxLoads, 0.50) - 1) * 100).toFixed(1)}%</span></div>`;
    }

    document.addEventListener('DOMContentLoaded', () => {
        initializeData();
        switchTab('story');
    });
    </script>

</body></html>